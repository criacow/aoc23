My method (which doesn't translate as well to code dump):
 - Create a graph of the test data (the commented-out lines);
 - Find the three lines that connect the two segments;
 - Make a copy of the text data, and remove those segments;
 - Count the number of connected edges in each segment.
